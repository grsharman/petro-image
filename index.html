<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OpenSeaDragon Split View Example</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/OpenSeadragonScalebar/2.0.0/openseadragon-scalebar.min.css"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@annotorious/openseadragon@latest/dist/annotorious-openseadragon.css">
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="viewer-container"></div>
    <div class="controls">
      <div>
        <select id="groupDropdown"></select>
      </div>
      <div>
        <select id="sampleDropdown"></select>
        <button id="info-button-desc">?
      </div>
      <div id="tooltip-desc" class="hidden"></div>
      <div>
        <input
          type="checkbox"
          id="image1"
          checked
          onclick="toggleImage(this, 0)"
        />
        <label for="image1">XPL1</label>
        <input
          type="checkbox"
          id="image2"
          checked
          onclick="toggleImage(this, 1)"
        />
        <label for="image2">XPL2</label>
      </div>
      <div>
        <input
          type="checkbox"
          id="image3"
          checked
          onclick="toggleImage(this, 2)"
        />
        <label for="image3">PPL</label>
      </div>
      <hr />
      <div>
        <details id="detailsMenu" closed>
          <summary>Grid</summary>
          <div>
          <input
          type="checkbox"
          id="show-grid"
          checked
          onclick="toggleGrid(this)"
        />
        <label for="show-grid">Show grid</label>
      <div>
        <label for="show-aoi">
          <input
          type="checkbox"
          id="show-aoi"
          onclick="updateAoiRectangle(this)"
          />Show AOI
        </label>
      </div>
      </div>
          <div>
            <label for="x_min">x<sub>min</sub></label>
            <input type="range" id="grid-left" name="x_min"
            min="0" value = "20" max="100" onchange="enableGridButtons()"/>
            <span class="slider-value" id="grid-left-value">20</span>
          </div>
          <div>
            <label for="x_max">x<sub>max</sub></label>
            <input type="range" id="grid-right" name="x_max" min="0" value = "80"
            max="100" onchange="enableGridButtons()"/>
            <span class="slider-value" id="grid-right-value">80</span>
          </div>
          <div>
            <label for="y_min">y<sub>min</sub></label>            
            <input type="range" id="grid-top" name="y_min" min="0" value = "0"
            max="100" onchange="enableGridButtons()"/>
            <span class="slider-value" id="grid-top-value">10</span>
          </div>
          <div>
            <label for="y_max">y<sub>max</sub></label>            
            <input type="range" id="grid-bottom" name="y_max" min="0" value = "90"
            max="100" onchange="enableGridButtons()"/>
            <span class="slider-value" id="grid-bottom-value">90</span>
          </div>
          <div>
            <label for="step-size">step:</label>
            <input
              id="step-size"
              class="number-input"
              type="number"
              value="1000"
              min="2"
              onchange="enableGridButtons()"
            />
          </div>
          <div>
            <label for="no-points"># points:</label>
            <input
              id="no-points"
              class="number-input"
              type="number"
              value="600"
              min="2"
              onchange="enableGridButtons()"
            />
          </div>
          <button id="apply-grid-settings" onclick="applyGridSettings()">
            Apply
          </button>
          <button
            id="restore-grid-settings"
            onclick="restoreGridSettings()"
            disabled
          >
            Restore
          </button>
        </details>
        <details closed>
          <summary>Count</summary>
          <div>
            <button id="prev-button" disabled>&larr;</button>
            <input type="number" id="sample-input" placeholder="1" maxlength="4" value="1" min="1" max="9999" disabled/>
            <button id="next-button" disabled>&rarr;</button>
          </div>
          <div>
            <input type="text" id="sample-text" placeholder="Label" disabled />
          </div>
          <div>
            <input type="text" id="sample-notes" placeholder="Notes" disabled />
          </div>
          <div>
            <div id="filterMenu">
              <button id="filterButton">Select</button>
              <div id="includeDropdown" class="dropdown-content" style="display: none;">
                <!-- Checkboxes will be added dynamically -->
              </div>
              <button onclick="showResults()">Summarize</button>
            </div>
          </div>
          <!-- Modal for displaying results -->
          <div id="resultsModal">
            <div id="modalContent">
                <span class="closeButton" onclick="closeModal()">&times;</span>
                <div id="resultsContent"></div>
            </div>
          </div>
          <!-- Filtering menu -->
          <div>
            <label for="filterDropdown">Filter:</label>
            <select id="filterDropdown" onchange="filterOverlays()">
                <option value="all">All</option> <!-- Default option -->
            </select>
          </div>
          <div>
            <button id="count-export" disabled>Export CSV</button>
          </div>

          <div class="file-input-container">
            <label for="count-file-input" class="file-label">Import CSV</label>
            <input type="file" id="count-file-input" class="file-input" />
          </div>
        </details>
      </div>
      <div>
        <details closed>
          <summary>Annotate</summary>
            <!-- Container for buttons -->
            <div class="button-container">
              <button class="custom-button" id="crosshairButton">
                <svg class="crosshairs-button" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <!-- Circle for center -->
                  <circle cx="12" cy="12" r="2" fill="#444" />
                  <!-- Horizontal line -->
                  <line x1="2" y1="12" x2="22" y2="12" stroke="#444" stroke-width="2" />
                  <!-- Vertical line -->
                  <line x1="12" y1="2" x2="12" y2="22" stroke="#444" stroke-width="2" />
                </svg>
              </button>
              <button class="custom-button" id="rectangleButton">
                <div class="square"></div>
              </button>
              <button class="custom-button" id="polygonButton">
                <svg class="polygon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                  <polygon points="50,10 90,35 73,85 27,85 10,35" fill="#444" />
                </svg>
              </button>
            </div>
          <div>
            <input
            type="checkbox"
            id="show-annotations"
            checked
            onclick="toggleAnnotation(this)"
          />
          <label for="show-annotation">Show annotations</label>
          <div>
            <button id="anno-prev-button" disabled>&larr;</button>
            <input type="number" id="anno-id" placeholder="1" maxlength="3" value="1" min="1" max="9999" disabled/>
            <button id="anno-next-button" disabled>&rarr;</button>
            <div>
              <input type="text" id="anno-label" placeholder="Label" disabled />
            </div>
            <div class="button-container">
              <!-- Trash can button -->
              <button class="custom-button" id="deleteButton" title="Delete">
                <svg class="trash-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <!-- Trash Can Outline -->
                  <path d="M9 3h6v2H9V3zm1 0v2h4V3h-4zM5 6h14v2H5V6zm2 3h10v11H7V9zm2 2v7h2v-7H9zm4 0v7h2v-7h-2z" />
                </svg>
              </button>
              <button class="custom-button" id="gearButton" title="Settings">
                <svg class="gear-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <!-- Gear Icon -->
                  <path d="M19.14,12.94a7.47,7.47,0,0,0,.05-1,7.47,7.47,0,0,0-.05-1l2.11-1.65a.51.51,0,0,0,.13-.65l-2-3.46a.5.5,0,0,0-.6-.22l-2.49,1a7.68,7.68,0,0,0-1.74-1l-.38-2.65A.49.49,0,0,0,12,1H9a.49.49,0,0,0-.49.42L8.13,4.07a7.68,7.68,0,0,0-1.74,1l-2.49-1a.5.5,0,0,0-.6.22l-2,3.46a.51.51,0,0,0,.13.65l2.11,1.65a7.47,7.47,0,0,0-.05,1,7.47,7.47,0,0,0,.05,1l-2.11,1.65a.51.51,0,0,0-.13.65l2,3.46a.5.5,0,0,0,.6.22l2.49-1a7.68,7.68,0,0,0,1.74,1l.38,2.65A.49.49,0,0,0,9,23h3a.49.49,0,0,0,.49-.42l.38-2.65a7.68,7.68,0,0,0,1.74-1l2.49,1a.5.5,0,0,0,.6-.22l2-3.46a.51.51,0,0,0-.13-.65Zm-7.14,2.51A4.5,4.5,0,1,1,16.5,11,4.5,4.5,0,0,1,12,15.45Z" />
                </svg>
              </button>
              <button id="unsavedChanges">No Unsaved Changes</button>
            </div>

            <!-- Hidden Settings Menu -->
            <div id="settingsMenu" class="menu">
              <input type="number" id="lwInput" placeholder="2" maxlength="3" value="2" min="1" max="10"/>
              <label for="annoLine">Line weight</label>
              
              <input type="number" id="annoOpacity" placeholder="1" maxlength="3" value="1" min="0" max="1"/>
              <label for="annoOpacity">Opacity</label>

              <input type="color" id="lineColorPicker" value="#008000"/>
              <label for="lineColorPicker">Border color</label>
              
              <input type="color" id="fillColorPicker" value="#FFFFFF"/>
              <label for="fillColorPicker">Fill color</label>
              
              <button id="applyCurrentAnno">Apply to Current</button>
              <button id="applyAllAnno">Apply to All</button>
            </div>

          </div>
          </div>
          <div>
            <input type="file" id="geojsonFileInput" accept=".geojson,.json" />
          </div>
          <div>
            <button id="loadAnnotationsBtn">Load</button>
            <button id="exportBtn">Export</button>
            <button id="clearBtn" onclick="clearAnnotations()">Clear</button>
          </div>
        </details>
      </div>
    </div>
    <script src="js/openseadragon.min.js"></script>
    <script src="js/openseadragon-scalebar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@annotorious/openseadragon@latest/dist/annotorious-openseadragon.js"></script>
    <script src="index.js"></script>
  </body>
</html>
